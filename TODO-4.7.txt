Masks:
======
* Old bitmask overlay window: Only list "real" bitmasks. What is real?
  E.g. Flag-related masks, masks set my reader, masks initially in the product,...
  It is only used for bitmask overlay, no mask management.
  ==> FINAL, ?, OPEN
* Mask manager shall test for dependencies before deleting
  ==> PRE, NF, OPEN
* Remove masks from product tree
  ==> PRE, NF, OPEN
* Add tool button for new VectorDataNode.
  ==> PRE, NF, OPEN
* Masks are inserted multiple times in product tree. Nodes are not removed on delete.
  ==> PRE, NF, DONE
* Old "zoom to ROI" missing
  ==> FINAL, ?, OPEN

VectorDataNode:
===============
* Need action to create new VectorDataNode.
  ==> DONE
* New VectorDataNode shall be selected in product tree
  ==> PRE, NF, OPEN
* Need action to delete existing VectorDataNode.
  ==>  PRE, NF, DONE partly, see TODOs in code
* Still need to transfer model-CRS into feature types.
  What about the image-CRS in Property DataStore? What is the EPSG code?!?!
  ==> PRE, MZ, OPEN
* When reprojecting (subsetting?) products, we must also transform geometry and
  align CRS of feature collections in vector data nodes!!! Use FeatureCollectionClipper
  in ShapefileLayer code. Pins/GCPs need special
  treatment!
  ==> PRE, MZ/*, OPEN
* Import shape/shapefile must create or insert into vector data node
  Check if GeoTools shapefile DataStore is already used.
  ==> PRE, MZ/*, OPEN
* Export vector data node to shapefile
  ==> FINAL, ?, OPEN
* Presentation name "Vector data" ==> "Geometries" + "Geometry", ...
  ==> PRE, RQ, OPEN

Figures:
========
* First zoom does not show zooming rectangle
  ==> PRE, MP, OPEN
* Make pin/GCP use a GeoTools feature --> and then a figure
  ==> PRE, RQ, OPEN
* Polygon bug: JTS wants 0 or 3 points.
  ==> PRE, NF, OPEN
* Still can't rotate figures. Remove handle in PRE?
  ==> FINAL, NF, OPEN
* Still no repaint while drawing new figures
  ==> PRE, RQ, OPEN
* Still can not add/remove geometry vertices
  ==> FINAL, NF, OPEN
* Move-Handle bug: many handles are created while dragging
  ==> PRE, MP, ONGOING
* Layer style editor doesn't work anymore
  ==> PRE, MP, OPEN
* New edit menu:
  - Test Cut/Copy/Paste!
  - What about Undo/Redo?!? (should work!)
  - After Paste: select inserted figures and displace a few (view) pixels
  ==> FINAL, ?, OPEN
* Allow for geometric operations on geometries: add/sub/intersection (JTS!)
  ==> FINAL, ?, OPEN
* Before using an insert line/polygon interaction, we need a target layer for the figures
  to be inserted:
  For pins/GCP: use existing, predefined vector data nodes and corresp. layers.
  For all others:
  1. If layer is selected AND layer is a vector layer  --> ok
  2. If not, display dialog: user can select existing vector data nodes, or create a new one.
      2.a Select choosen vector data node in VISAT
      2.b If layer exists, select it, otherwise create new layer, and select --> ok
  ==> PRE, NF/MP, OPEN

Layers:
=======
* Remove old Pin/GCP/Figure Layers, also code!
  ==> PRE, RQ, OPEN
* Auto-create vector data layer if new vector data nores are created/deleted...
  ==> PRE, NF/MP, DONE
* When a vector data layer detects new incoming features the style is always the default style:
  Black fill, no stroke
  ==> PRE, RQ, OPEN

CrsGeoCoding:
=============
* Rename CrsGeoCoding into DefaultGeoCoding.
  ==> FINAL, ?, OPEN
* Deprecate map package and remove usage.
  ==> FINAL, ?, OPEN

GeoCoding.getDatum():
=====================
* It is still the "old" BEAM Datum and should have already been replaced by the GeoTools one.
  Deprecate. Review.
  ==> FINAL, ?, DONE?


<X>LayerType:
=============
* We once decided that we wanted to introduce static factory methods for each(!) layer type
  following the JAI-Descriptor concept. Nothing done so far.
  ==> FINAL, ?, OPEN
* Don't use class names e.g. in Session I/O.
  ==> FINAL, ?, OPEN

Geometry RasterDataNode.areaOfInterest:
========================================
* We need this new property for boosting statistics computation
  and possibly also display. This property is optional but some product
  readers may set it, e.g. SMOS reader. Tile bounds can easily be
  tested for intersection with areaOfInterest and possibly ignored.
  Also very important for S3/SMOS-Box!
  ==> FINAL, ?, OPEN

FeatureLayer:
=============

Several problems:
- Property name: Target-CRS is named FC-CRS, which is actually a view CRS.
- Clipping done against WGS84-CRS geometry if and only if feature ceollection has not been loaded from a shapefile (?!?).
  ==> FINAL, ?, OPEN

Mask DIMAP I/O
==============
- Product.maskGroup
  ==> DONE
- RasterDataNode.overlayMaskGroup, RasterDataNode.roiMaskGroup
  ==> PRE, RQ/MZ, OPEN

Other API Stuff:
================
Avoid adding too much node listeners to a product:
   abstract ProductNode.handleRename(node, oldName, newName)
   abstract ProductNode.handleNodeDataChanged(node, oldName, newName)


GUI Tests results
==============
new mosaic processor
------------------
- has no menu and therefore it is not possible to work with the request files

masks, vectors, layers
-----------------------
- Deleting of a band, mask, vector causes NullPointerexception
- Selection mask in the Mask manager causes duplication of this mask in the mask node of the product tree
- 3 PINs but in Statistic: "Number of considered pixels: 2"
- zoom to figger
- black drawing under the figger
- vector mark for pin/gcp will be zoomed with the image view
- edit mask ->  changes will not applyed

save product/session
------------
- create new vector data - save - close - open session --> NullPointerException
java.lang.NullPointerException
        at org.esa.beam.framework.ui.product.VectorDataLayer.<init>(VectorDataLayer.java:55)
        at org.esa.beam.framework.ui.product.VectorDataLayerType.createLayer(VectorDataLayerType.java:57)
        at org.esa.beam.framework.ui.product.VectorDataLayerType.createLayer(VectorDataLayerType.java:46)
        at org.esa.beam.visat.actions.session.Session.addLayerRef(Session.java:436)
        at org.esa.beam.visat.actions.session.Session.addLayerRef(Session.java:443)
        at org.esa.beam.visat.actions.session.Session.collectSceneView(Session.java:343)
        at org.esa.beam.visat.actions.session.Session.restoreViews(Session.java:308)
        at org.esa.beam.visat.actions.session.Session.restore(Session.java:256)
        at org.esa.beam.visat.actions.session.OpenSessionAction$OpenSessionWorker.doInBackground(OpenSessionAction.java:114)
        at org.esa.beam.visat.actions.session.OpenSessionAction$OpenSessionWorker.doInBackground(OpenSessionAction.java:99)
        at com.bc.ceres.swing.progress.ProgressMonitorSwingWorker.doInBackground(ProgressMonitorSwingWorker.java:42)

- roi is lost by save session; save - close - open session --> roi will not be preselected  ?


//////////////////////////////////////////////////////////////////////////////////////
// TODO put in Wiki

h2. API changes:

h3. Product Data Model Changes
* Introduced Mask class
* Introduced VectorDataNode class
* Product class
** Added new methods to Product class
**# ProductNodeGroup<VectorData> getVectorDataGroup()
**# ProductNodeGroup<Mask> getMaskGroup()
** Deprecated a lot of old methods deling with {{BitRaster}} and bitmasks in general
** Change events for the following "properties" are not fired anymore: modified, owner 
* Added new methods to ProductVisitor interface:
*# void visit(Mask mask)
*# void visit(VectorDataNode dataNode)
* ProductNode class
** Rename updateExpression(s1, s2) to handleRename(node, s1, s2)  (TODO!)

h3. Ceres Binding API Changes

* Terminology changes followed by extensive renamings:
** ValueModel --> Property
** ValueDescriptor --> PropertyDescriptor
** ValueContainer --> PropertyContainer
** ValueAccessor --> PropertyAccessor
** ClassFieldDescriptorFactory --> PropertyDescriptorFactory
** ValueDescriptor.properties --> PropertyDescriptor.attributes (incl. all accessors)
* New interface PropertyAccessorFactory
* PropertyContainer.setValue(String propertyName, Object value) now throws IllegalArgumentException
 by wrapping a previously thrown ValidationException.

* PropertySet is an interface which has been extracted from PropertyContainer.
  Thus, in many places (including public BEAM API) the use of PropertyContainer has been replaced by PropertySet

* ValueEditor --> PropertyEditor
* ValueEditorRegistry --> PropertyEditorRegistry
* ValueEditorsPane --> PropertyPane


h3. Ceres Layer API Changes

* Renamed method LayerType.getConfigurationTemplate() to  createLayerConfig()
* Moved methods LayerType.createDefaultValueModel() ValueModel.createValueModel()

h3. Ceres Core API Changes
* Renamed class ServiceRegistryFactory to ServiceRegistryManager
